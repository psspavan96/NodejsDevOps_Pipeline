1) Open your terminal/Command Prompt

2) Create a folder on your local machine by using the command:
                        mkdir terraform

3) Go the folder and create a new file inside the folder by using following commands:

                         vi gce.tf (Mac OS)
Go to Notepad and save the name of the file as gce.tf in the terraform folder (Windows)

4) Copy the following code into the terraform file

// Configure the Google Cloud provider
provider "google" {
 // Specify the path of the JSON credentials file
 credentials = file("/full_path/Credentials.json")
 project     = "your_project_name"
 region      = "your_region"
}


// A single Compute Engine instance
resource "google_compute_instance" "default" {
 name         = "myinstance"
 machine_type = "f1-micro"
 zone         = "your_zone"

 boot_disk {
    initialize_params {
      image = "ubuntu-1804-lts"
    }
  }
 
 network_interface {
   network = "default"
 }
}

// Firewall Rules
resource "google_compute_firewall" "default" {
  name    = "my-firewall"
  network = google_compute_network.default.name

  allow {
    protocol = "icmp"
  }

  allow {
    protocol = "tcp"
    // Specify the ports that you want to access
    ports    = ["80", "8080", "1000-2000"] 
  }

  source_tags = ["web"]
}

resource "google_compute_network" "default" {
  name = "my-network"
}


5) Before executing the “terraform init” command, make sure that you have generated a key file.

6) In case, if you have not generated the key file, following are the steps to generate the key file:
    • Go to your Google Cloud console from your web browser
    • Go to Menu > IAM & Admin > Service accounts
    • Click on Create Service Account
    • Specify the account name and click on create and specify the role as “Compute Admin”
    • Click on Continue and Click on Done.
    • To generate the key go to the Service Accounts home page and Click on Actions > Create Key > Select Key Type as “JSON” > Click on create > Specify the filename > Click Save
      
7)Once you specify the path to the json file, project name, region and zone in the terraform file, run terraform init to initialize a working directory containing Terraform configuration files.

8) Once the directory is initialized, run terraform plan command to generate an execution plan to reach the desired state.

9) Once the plan is generated, run terraform apply to apply the changes required to reach the desired state of the configuration.

10) Once your instance is created, go to the VM instance in the web browser and SSH into the instance and type "sudo su" command in the terminal to go to the root.
